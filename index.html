<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sens√∂r Araba Yarƒ±≈üƒ±</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            margin: 0;
            padding: 0;
            background: linear-gradient(to bottom, #87CEEB, #90EE90);
            font-family: 'Arial', sans-serif;
            overflow: hidden;
            user-select: none;
        }

        #gameContainer {
            position: relative;
            width: 100vw;
            height: 100vh;
            background: 
                linear-gradient(to right, #228B22 0%, #228B22 18%, #404040 18%, #404040 82%, #228B22 82%, #228B22 100%);
            overflow: hidden;
        }

        .road-line {
            position: absolute;
            width: 4px;
            height: 40px;
            background: white;
            left: 50%;
            transform: translateX(-50%);
        }

        #car {
            position: absolute;
            width: 40px;
            height: 70px;
            background: linear-gradient(45deg, #FF6B6B, #FF8E53);
            border-radius: 10px 10px 5px 5px;
            bottom: 100px;
            left: 50%;
            transform: translateX(-50%);
            transition: left 0.1s ease;
            box-shadow: 0 0 15px rgba(255, 107, 107, 0.7);
            border: 2px solid #fff;
            z-index: 10;
        }

        #car::before {
            content: '';
            position: absolute;
            width: 30px;
            height: 20px;
            background: #87CEEB;
            top: 10px;
            left: 5px;
            border-radius: 3px;
        }

        .obstacle {
            position: absolute;
            width: 45px;
            height: 60px;
            background: linear-gradient(45deg, #8B0000, #DC143C);
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(139, 0, 0, 0.8);
            border: 2px solid #fff;
        }

        .obstacle::before {
            content: '';
            position: absolute;
            width: 35px;
            height: 15px;
            background: #333;
            top: 8px;
            left: 5px;
            border-radius: 2px;
        }

        #ui {
            position: absolute;
            top: 20px;
            left: 20px;
            color: white;
            font-weight: bold;
            z-index: 100;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
        }

        #speed {
            position: absolute;
            top: 20px;
            right: 20px;
            color: white;
            font-weight: bold;
            z-index: 100;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
        }

        #gameOver {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            display: none;
            z-index: 200;
            border: 3px solid #FF6B6B;
        }

        #startScreen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 300;
            text-align: center;
        }

        .btn-custom {
            background: linear-gradient(45deg, #FF6B6B, #FF8E53);
            border: none;
            color: white;
            padding: 15px 30px;
            font-size: 18px;
            border-radius: 25px;
            box-shadow: 0 4px 15px rgba(255, 107, 107, 0.4);
            transition: all 0.3s ease;
        }

        .btn-custom:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 107, 107, 0.6);
        }

        .instruction {
            margin: 10px 0;
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            backdrop-filter: blur(10px);
            max-width: 400px;
        }

        #sensorDebug {
            position: absolute;
            bottom: 20px;
            left: 20px;
            color: white;
            font-size: 14px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.8);
            background: rgba(0,0,0,0.8);
            padding: 15px;
            border-radius: 8px;
            max-width: 300px;
            border: 2px solid #4CAF50;
        }

        .sensor-active {
            border-color: #4CAF50 !important;
            background: rgba(76, 175, 80, 0.2) !important;
        }

        .sensor-inactive {
            border-color: #f44336 !important;
            background: rgba(244, 67, 54, 0.2) !important;
        }

        #instructions {
            position: absolute;
            top: 80px;
            right: 20px;
            color: white;
            font-size: 12px;
            background: rgba(0,0,0,0.7);
            padding: 10px;
            border-radius: 5px;
            max-width: 200px;
        }

        .tilt-demo {
            display: inline-block;
            margin: 5px;
            padding: 8px 12px;
            background: rgba(255,255,255,0.2);
            border-radius: 5px;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div id="gameContainer">
        <div id="startScreen">
            <h1 class="mb-4">üì± Sens√∂r Araba Yarƒ±≈üƒ±</h1>
            <div class="instruction">
                <h5>üì± Kalibrasyon Sistemi!</h5>
                <p><strong>1Ô∏è‚É£ Telefonu D√úZ tut</strong></p>
                <p><strong>2Ô∏è‚É£ "Ba≈ülat" butonuna bas</strong></p>
                <p><strong>3Ô∏è‚É£ 3 saniye kalibre olacak</strong></p>
                
                <div class="mt-3" style="background: rgba(255,255,0,0.2); padding: 10px; border-radius: 5px;">
                    <small><strong>‚ö†Ô∏è √ñnemli:</strong><br>
                    Ba≈ülarken telefonu D√úZ konumda tut!<br>
                    Bu pozisyon merkez olarak kaydedilecek.</small>
                </div>
            </div>
            <button class="btn btn-custom mt-4" onclick="startSensorGame()">Sens√∂r Oyununu Ba≈ülat</button>
            <div id="permissionStatus" class="mt-3"></div>
        </div>

        <div id="ui">
            <div>Skor: <span id="score">0</span></div>
            <div>Seviye: <span id="level">1</span></div>
        </div>

        <div id="speed">
            <div>Hƒ±z: <span id="speedometer">50</span> km/h</div>
        </div>

        <div id="instructions">
            <div><strong>üì± Kontrol:</strong></div>
            <div>Sola eƒü ‚Üê Sola git</div>
            <div>Saƒüa eƒü ‚Üí Saƒüa git</div>
            <div>√ñne eƒü ‚Üë Hƒ±zlan</div>
            <div>Arkaya eƒü ‚Üì Yava≈üla</div>
        </div>

        <div id="sensorDebug">
            <div><strong>üîç Sens√∂r Durum:</strong></div>
            <div>Durum: <span id="sensorStatus">Bekleniyor...</span></div>
            <div>Kalibrasyon: <span id="calibrationStatus">Beklemede</span></div>
            <div>Ham Gamma: <span id="gammaDisplay">0</span>¬∞</div>
            <div>D√ºzeltilmi≈ü: <span id="correctedGamma">0</span>¬∞</div>
            <div>Beta: <span id="betaDisplay">0</span>¬∞</div>
            <div><small>Yol sƒ±nƒ±rlarƒ±: 20%-80%</small></div>
        </div>

        <div id="car"></div>

        <div id="gameOver">
            <h2>üèÅ Oyun Bitti!</h2>
            <p>Final Skorun: <span id="finalScore">0</span></p>
            <p>Ula≈ütƒ±ƒüƒ±n Seviye: <span id="finalLevel">1</span></p>
            <button class="btn btn-custom mt-3" onclick="restartGame()">Tekrar Oyna</button>
        </div>
    </div>

    <script>
        let gameRunning = false;
        let score = 0;
        let level = 1;
        let speed = 50;
        let carPosition = 50;
        let obstacles = [];
        let gameSpeed = 1;
        let roadLines = [];
        let sensorWorking = false;
        let baseGamma = 0; // Telefon d√ºz tutma referansƒ±
        let calibrationDone = false;

        const car = document.getElementById('car');
        const gameContainer = document.getElementById('gameContainer');
        const scoreElement = document.getElementById('score');
        const levelElement = document.getElementById('level');
        const speedElement = document.getElementById('speedometer');
        const gameOverScreen = document.getElementById('gameOver');
        const startScreen = document.getElementById('startScreen');
        const sensorDebug = document.getElementById('sensorDebug');

        // √áoklu sens√∂r sistemi - T√ºm y√∂ntemleri dene
        async function startSensorGame() {
            const statusElement = document.getElementById('permissionStatus');
            statusElement.innerHTML = 'üîç T√ºm sens√∂r t√ºrleri test ediliyor...';
            statusElement.className = 'mt-3 text-info';

            // √ñnce temel kontrolleri yap
            console.log('=== SENS√ñR TESTƒ∞ BA≈ûLIYOR ===');
            console.log('URL Protocol:', window.location.protocol);
            console.log('User Agent:', navigator.userAgent);
            console.log('DeviceOrientationEvent support:', typeof DeviceOrientationEvent !== 'undefined');
            console.log('DeviceMotionEvent support:', typeof DeviceMotionEvent !== 'undefined');

            // HTTPS kontrol√º
            if (window.location.protocol !== 'https:' && window.location.hostname !== 'localhost') {
                statusElement.innerHTML = '‚ùå HTTPS gerekli! Sens√∂rler sadece g√ºvenli baƒülantƒ±larda √ßalƒ±≈üƒ±r.<br><small>localhost veya https:// kullanƒ±n</small>';
                statusElement.className = 'mt-3 text-danger';
                return;
            }

            try {
                // Test 1: iOS 13+ izni
                await requestIOSPermissions(statusElement);
                
                // Test 2: Yeni Sensor API'lerini dene
                await tryModernSensorAPIs(statusElement);
                
                // Test 3: Geleneksel sens√∂rleri dene
                await tryLegacySensors(statusElement);
                
                // Test 4: Alternatif y√∂ntemleri dene
                tryAlternativeMethods(statusElement);
                
                // Oyunu ba≈ülat + kalibrasyon
                setTimeout(() => {
                    startCalibration();
                    setTimeout(() => {
                        startScreen.style.display = 'none';
                        gameRunning = true;
                        initGame();
                        gameLoop();
                    }, 3500); // Kalibrasyon sonrasƒ± ba≈ülat
                }, 1000);

            } catch (error) {
                console.error('Sens√∂r hatasƒ±:', error);
                statusElement.innerHTML = '‚ùå Sens√∂r hatasƒ±: ' + error.message;
                statusElement.className = 'mt-3 text-danger';
            }
        }

        // iOS izinleri iste
        async function requestIOSPermissions(statusElement) {
            if (typeof DeviceOrientationEvent.requestPermission === 'function') {
                statusElement.innerHTML = 'üì± iOS sens√∂r izni isteniyor...';
                const orientationResponse = await DeviceOrientationEvent.requestPermission();
                console.log('iOS Orientation Permission:', orientationResponse);
                
                if (orientationResponse !== 'granted') {
                    throw new Error('iOS Orientation izni reddedildi');
                }
            }

            if (typeof DeviceMotionEvent.requestPermission === 'function') {
                const motionResponse = await DeviceMotionEvent.requestPermission();
                console.log('iOS Motion Permission:', motionResponse);
            }
        }

        // Modern Sensor API'lerini dene
        async function tryModernSensorAPIs(statusElement) {
            statusElement.innerHTML = 'üî¨ Modern Sensor API test ediliyor...';
            
            if ('AbsoluteOrientationSensor' in window) {
                try {
                    const sensor = new AbsoluteOrientationSensor({ frequency: 60 });
                    sensor.addEventListener('reading', handleModernSensor);
                    sensor.addEventListener('error', (event) => {
                        console.log('AbsoluteOrientationSensor error:', event.error);
                    });
                    sensor.start();
                    
                    console.log('AbsoluteOrientationSensor started');
                    document.getElementById('sensorStatus').textContent = 'Modern API ‚úÖ';
                    sensorWorking = true;
                    return;
                } catch (error) {
                    console.log('AbsoluteOrientationSensor failed:', error);
                }
            }

            if ('RelativeOrientationSensor' in window) {
                try {
                    const sensor = new RelativeOrientationSensor({ frequency: 60 });
                    sensor.addEventListener('reading', handleModernSensor);
                    sensor.start();
                    
                    console.log('RelativeOrientationSensor started');
                    document.getElementById('sensorStatus').textContent = 'Relative API ‚úÖ';
                    sensorWorking = true;
                    return;
                } catch (error) {
                    console.log('RelativeOrientationSensor failed:', error);
                }
            }
        }

        // Modern sens√∂r verilerini i≈üle
        function handleModernSensor(event) {
            if (!gameRunning) return;
            
            const quaternion = event.target.quaternion;
            if (quaternion) {
                // Quaternion'dan Euler a√ßƒ±larƒ±na d√∂n√º≈üt√ºr (basitle≈ütirilmi≈ü)
                const gamma = Math.atan2(2 * (quaternion[0] * quaternion[1] + quaternion[2] * quaternion[3]), 
                                        1 - 2 * (quaternion[1] ** 2 + quaternion[2] ** 2)) * (180/Math.PI);
                const beta = Math.asin(2 * (quaternion[0] * quaternion[2] - quaternion[3] * quaternion[1])) * (180/Math.PI);
                
                document.getElementById('gammaDisplay').textContent = gamma.toFixed(1);
                document.getElementById('betaDisplay').textContent = beta.toFixed(1);
                
                // Araba kontrol√º
                controlCarWithSensorData(gamma, beta);
            }
        }

        // Geleneksel sens√∂rleri dene
        async function tryLegacySensors(statusElement) {
            statusElement.innerHTML = 'üì° Geleneksel sens√∂rler test ediliyor...';
            
            // DeviceOrientation
            window.addEventListener('deviceorientation', handleLegacyOrientation, true);
            
            // DeviceMotion
            window.addEventListener('devicemotion', handleLegacyMotion, true);
            
            console.log('Legacy sensor listeners added');
        }

        // Geleneksel orientation handler
        function handleLegacyOrientation(event) {
            const gamma = event.gamma;
            const beta = event.beta;
            const alpha = event.alpha;

            if (gamma !== null && beta !== null) {
                sensorWorking = true;
                document.getElementById('sensorStatus').textContent = 'Legacy Orientation ‚úÖ';
                document.getElementById('gammaDisplay').textContent = gamma.toFixed(1);
                document.getElementById('betaDisplay').textContent = beta.toFixed(1);
                sensorDebug.className = 'sensor-active';

                if (gameRunning) {
                    controlCarWithSensorData(gamma, beta);
                }
            }
        }

        // Geleneksel motion handler
        function handleLegacyMotion(event) {
            if (sensorWorking) return; // Orientation √ßalƒ±≈üƒ±yorsa kullanma

            const acc = event.accelerationIncludingGravity;
            if (acc && (acc.x !== null || acc.y !== null)) {
                sensorWorking = true;
                document.getElementById('sensorStatus').textContent = 'Legacy Motion ‚úÖ';
                document.getElementById('gammaDisplay').textContent = `AccX: ${acc.x?.toFixed(1) || '0'}`;
                document.getElementById('betaDisplay').textContent = `AccY: ${acc.y?.toFixed(1) || '0'}`;
                sensorDebug.className = 'sensor-active';

                if (gameRunning && acc.x !== null) {
                    // Accelerometer ile kontrol
                    const gamma = acc.x * -15; // Scale and invert
                    const beta = acc.y * 15;
                    controlCarWithSensorData(gamma, beta);
                }
            }
        }

        // Alternatif y√∂ntemler
        function tryAlternativeMethods(statusElement) {
            statusElement.innerHTML = 'üîÑ Alternatif y√∂ntemler deneniyor...';
            
            // Gyroscope API dene
            if ('Gyroscope' in window) {
                try {
                    const gyroscope = new Gyroscope({ frequency: 60 });
                    gyroscope.addEventListener('reading', () => {
                        console.log('Gyroscope:', gyroscope.x, gyroscope.y, gyroscope.z);
                    });
                    gyroscope.start();
                } catch (error) {
                    console.log('Gyroscope failed:', error);
                }
            }

            // Accelerometer API dene
            if ('Accelerometer' in window) {
                try {
                    const accelerometer = new Accelerometer({ frequency: 60 });
                    accelerometer.addEventListener('reading', () => {
                        console.log('Accelerometer:', accelerometer.x, accelerometer.y, accelerometer.z);
                    });
                    accelerometer.start();
                } catch (error) {
                    console.log('Accelerometer failed:', error);
                }
            }

            // Manuel sens√∂r kontrol√º (eski cihazlar i√ßin)
            setTimeout(() => {
                if (!sensorWorking) {
                    statusElement.innerHTML = '‚ùå Hi√ßbir sens√∂r √ßalƒ±≈ümƒ±yor. Manuel kontrol √∂nerilir.';
                    statusElement.className = 'mt-3 text-danger';
                    document.getElementById('sensorStatus').textContent = '√áalƒ±≈ümƒ±yor ‚ùå';
                    sensorDebug.className = 'sensor-inactive';
                }
            }, 3000);
        }

        // Kalibrasyon sistemi - Geli≈ütirilmi≈ü
        function startCalibration() {
            console.log('=== KALƒ∞BRASYON BA≈ûLIYOR ===');
            document.getElementById('calibrationStatus').textContent = 'Kalibrasyon...';
            
            let calibrationValues = [];
            let calibrationCount = 0;
            
            const calibrationInterval = setInterval(() => {
                calibrationCount++;
                console.log(`Kalibrasyon ${calibrationCount}/50`); // Daha uzun kalibrasyon
                
                if (calibrationCount >= 50) { // 5 saniye (50 * 100ms)
                    // Medyan deƒüeri hesapla (daha stabil)
                    if (calibrationValues.length > 0) {
                        calibrationValues.sort((a, b) => a - b);
                        const middle = Math.floor(calibrationValues.length / 2);
                        baseGamma = calibrationValues.length % 2 === 0 
                            ? (calibrationValues[middle - 1] + calibrationValues[middle]) / 2
                            : calibrationValues[middle];
                        
                        calibrationDone = true;
                        document.getElementById('calibrationStatus').textContent = `Tamamlandƒ± (${baseGamma.toFixed(1)}¬∞)`;
                        console.log('Kalibrasyon tamamlandƒ± - Base Gamma:', baseGamma);
                    } else {
                        baseGamma = 0;
                        calibrationDone = true;
                        document.getElementById('calibrationStatus').textContent = 'Sens√∂r yok - Manuel';
                        console.log('Sens√∂r verisi yok, manual mod');
                    }
                    clearInterval(calibrationInterval);
                }
            }, 100);
            
            // Kalibrasyon i√ßin ge√ßici listener
            window.addEventListener('deviceorientation', function calibrationListener(event) {
                if (event.gamma !== null && calibrationCount <= 50) {
                    calibrationValues.push(event.gamma);
                }
                
                if (calibrationCount > 50) {
                    window.removeEventListener('deviceorientation', calibrationListener);
                }
            });
        }

        // Geli≈ütirilmi≈ü araba kontrol fonksiyonu
        function controlCarWithSensorData(gamma, beta) {
            // Ham deƒüerleri g√∂ster
            document.getElementById('gammaDisplay').textContent = gamma.toFixed(1);
            document.getElementById('betaDisplay').textContent = beta.toFixed(1);
            
            // Kalibrasyon uygulanmƒ±≈üsa d√ºzelt
            let correctedGamma = gamma;
            if (calibrationDone) {
                correctedGamma = gamma - baseGamma;
            }
            
            // D√ºzeltilmi≈ü deƒüeri g√∂ster
            document.getElementById('correctedGamma').textContent = correctedGamma.toFixed(1);
            
            // Saƒü-Sol hareket - Kalibrasyon uygulanmƒ±≈ü
            if (Math.abs(correctedGamma) > 3) { // Minimum e≈üik
                const moveAmount = correctedGamma * 0.5; // Hassasiyet azaltƒ±ldƒ±
                carPosition += moveAmount;
                
                // YOL SINIRLARI - Araba yoldan √ßƒ±kamasƒ±n
                carPosition = Math.max(22, Math.min(78, carPosition)); // Yol %20-%80 arasƒ±
                
                updateCarPosition();
                console.log('Hareket - Ham:', gamma.toFixed(1), 'D√ºzeltilmi≈ü:', correctedGamma.toFixed(1), 'Pozisyon:', carPosition.toFixed(1));
            }

            // Oto-ortalama - Telefon d√ºzse arabayƒ± merkeze √ßek
            if (Math.abs(correctedGamma) < 2) {
                const centerPull = (50 - carPosition) * 0.02; // Merkeze √ßekme kuvveti
                carPosition += centerPull;
                carPosition = Math.max(22, Math.min(78, carPosition));
                updateCarPosition();
            }

            // Hƒ±z kontrol√º - Daha az hassas
            const normalBeta = 45;
            const betaDiff = beta - normalBeta;
            
            if (Math.abs(betaDiff) > 25) { // Y√ºksek e≈üik
                if (betaDiff < -25) {
                    speed = Math.min(120, speed + 0.5);
                    gameSpeed = speed / 50;
                    updateSpeed();
                } else if (betaDiff > 25) {
                    speed = Math.max(20, speed - 0.5);
                    gameSpeed = speed / 50;
                    updateSpeed();
                }
            }
        }

        function updateCarPosition() {
            // Yol sƒ±nƒ±rlarƒ±nƒ± zorla uygula
            carPosition = Math.max(22, Math.min(78, carPosition));
            car.style.left = carPosition + '%';
            car.style.transform = `translateX(-50%)`;
        }

        function updateSpeed() {
            speedElement.textContent = Math.round(speed);
        }

        function initGame() {
            score = 0;
            level = 1;
            speed = 10; // Ba≈ülangƒ±√ß hƒ±zƒ± 10 km/h
            carPosition = 50; // Ortada ba≈ülat
            gameSpeed = 0.2; // √áok yava≈ü ba≈üla
            obstacles = [];
            roadLines = [];
            
            // Arabayƒ± merkeze yerle≈ütir
            updateCarPosition();
            updateUI();
            createRoadLines();
            
            console.log('Oyun ba≈ülatƒ±ldƒ± - Ba≈ülangƒ±√ß hƒ±zƒ±: 10 km/h');
        }

        function createRoadLines() {
            const lineInterval = setInterval(() => {
                if (!gameRunning) {
                    clearInterval(lineInterval);
                    return;
                }
                
                const line = document.createElement('div');
                line.className = 'road-line';
                line.style.top = '-40px';
                gameContainer.appendChild(line);

                let position = -40;
                const animate = () => {
                    if (!gameRunning) return;
                    position += gameSpeed * 4;
                    line.style.top = position + 'px';
                    
                    if (position > window.innerHeight) {
                        if (line.parentNode) line.parentNode.removeChild(line);
                    } else {
                        requestAnimationFrame(animate);
                    }
                };
                animate();
            }, 300);
        }

        function createObstacle() {
            console.log('Yeni engel yaratƒ±lƒ±yor...');
            const obstacle = document.createElement('div');
            obstacle.className = 'obstacle';
            
            // Yol sƒ±nƒ±rlarƒ± i√ßinde ≈üeritler
            const lanes = [30, 50, 70]; // Yol i√ßinde kalacak ≈üekilde
            const selectedLane = lanes[Math.floor(Math.random() * lanes.length)];
            obstacle.style.left = selectedLane + '%';
            obstacle.style.top = '-80px';
            obstacle.style.transform = 'translateX(-50%)';
            
            gameContainer.appendChild(obstacle);
            obstacles.push(obstacle);
            
            console.log('Engel yaratƒ±ldƒ± - ≈ûerit:', selectedLane + '%');

            let position = -80;
            const animate = () => {
                if (!gameRunning) return;
                position += gameSpeed * 3;
                obstacle.style.top = position + 'px';
                
                if (position > window.innerHeight) {
                    if (obstacle.parentNode) {
                        obstacle.parentNode.removeChild(obstacle);
                    }
                    obstacles = obstacles.filter(obs => obs !== obstacle);
                } else {
                    requestAnimationFrame(animate);
                }
            };
            animate();
        }

        function checkCollision() {
            const carRect = car.getBoundingClientRect();
            
            obstacles.forEach(obstacle => {
                const obstacleRect = obstacle.getBoundingClientRect();
                
                if (carRect.left < obstacleRect.right &&
                    carRect.right > obstacleRect.left &&
                    carRect.top < obstacleRect.bottom &&
                    carRect.bottom > obstacleRect.top) {
                    gameOver();
                }
            });
        }

        function updateScore() {
            score += Math.round(speed / 10);
            
            if (score > level * 400) {
                level++;
                gameSpeed = Math.min(2.5, gameSpeed + 0.15);
            }
            
            updateUI();
        }

        function updateUI() {
            scoreElement.textContent = score;
            levelElement.textContent = level;
        }

        function gameOver() {
            gameRunning = false;
            document.getElementById('finalScore').textContent = score;
            document.getElementById('finalLevel').textContent = level;
            gameOverScreen.style.display = 'block';
            
            obstacles.forEach(obstacle => {
                if (obstacle.parentNode) obstacle.parentNode.removeChild(obstacle);
            });
            obstacles = [];
        }

        function restartGame() {
            gameOverScreen.style.display = 'none';
            gameRunning = true;
            initGame();
        }

        function gameLoop() {
            if (!gameRunning) return;

            checkCollision();
            updateScore();

            // Engel yaratma - Daha sƒ±k ve garantili
            const obstacleChance = 0.02 + (level * 0.005); // Seviye arttƒ±k√ßa daha sƒ±k
            if (Math.random() < obstacleChance) {
                createObstacle();
                console.log('Engel yaratma ≈üansƒ±:', obstacleChance);
            }

            requestAnimationFrame(gameLoop);
        }

        // Ba≈ülangƒ±√ß konsol mesajƒ±
        console.log('üì± Sens√∂r Araba Yarƒ±≈üƒ± y√ºklendi! Telefon sens√∂rleri ile oynayƒ±n.');
    </script>
</body>
</html>